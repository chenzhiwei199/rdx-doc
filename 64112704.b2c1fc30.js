(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{100:function(t,e,n){"use strict";n.r(e),n.d(e,"frontMatter",(function(){return h})),n.d(e,"metadata",(function(){return y})),n.d(e,"rightToc",(function(){return E})),n.d(e,"default",(function(){return w}));var r={};n.r(r),n.d(r,"Root",(function(){return v}));var a=n(2),u=n(6),o=n(0),s=n.n(o),i=n(136),l=n(153),c=n(777),d=n(826),p=n(694),m=function(t,e,n,r){return new(n||(n=Promise))((function(a,u){function o(t){try{i(r.next(t))}catch(e){u(e)}}function s(t){try{i(r.throw(t))}catch(e){u(e)}}function i(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}i((r=r.apply(t,e||[])).next())}))},b=function(t,e){var n,r,a,u,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return u={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function s(u){return function(s){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&u[0]?r.return:u[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,u[1])).done)return a;switch(r=0,a&&(u=[2&u[0],a.value]),u[0]){case 0:case 1:a=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,r=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!a||u[1]>a[0]&&u[1]<a[3])){o.label=u[1];break}if(6===u[0]&&o.label<a[1]){o.label=a[1],a=u;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(u);break}a[2]&&o.ops.pop(),o.trys.pop();continue}u=e.call(t,o)}catch(s){u=[6,s],r=0}finally{n=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},f=function(t){return new Promise((function(e){return setTimeout(e,t)}))},x=Object(c.a)({id:"asyncCompute",get:function(){return m(void 0,void 0,void 0,(function(){return b(this,(function(t){switch(t.label){case 0:return[4,f(2e3)];case 1:return t.sent(),[2,"\u5ef6\u8fdf2s\u7684\u6570\u636e"]}}))}))}}),g=Object(c.a)({id:"asyncCompute22222",get:function(){return m(void 0,void 0,void 0,(function(){return b(this,(function(t){switch(t.label){case 0:return[4,f(4e3)];case 1:return t.sent(),[2,"\u5ef6\u8fdf4s\u7684\u6570\u636e"]}}))}))}}),S=Object(c.a)({id:"errorCompute",get:function(){return m(void 0,void 0,void 0,(function(){return b(this,(function(t){switch(t.label){case 0:return[4,f(3e3)];case 1:throw t.sent(),new Error("\u9519\u8bef\u72b6\u6001\u7684\u4f8b\u5b50")}}))}))}}),v=function(){return s.a.createElement(d.a,null,s.a.createElement(R,null))},R=function(){var t=Object(p.k)(),e=Object(p.k)(),n=Object(p.l)(x,t),r=Object(p.l)(g,t),a=Object(p.l)(S,e);return s.a.createElement("div",{style:{}},s.a.createElement("div",null,s.a.createElement("strong",null,"Error state"),e.isAnyError()?e.getErrors().map((function(t){return t.msg})):e.isAnyPending()?"\u52a0\u8f7d\u4e2d\u3002\u3002\u3002":a),s.a.createElement("div",null,s.a.createElement("strong",null,"Parial state"),s.a.createElement("div",null,"\u52a0\u8f7d\u6570\u636e1:",t.isPending(x)?"\u52a0\u8f7d\u4e2d":n),s.a.createElement("div",null,"\u52a0\u8f7d\u6570\u636e2:",t.isPending(g)?"\u52a0\u8f7d\u4e2d":r)),s.a.createElement("div",null,s.a.createElement("strong",null,"isAnyPending"),t.isAnyPending()?"\u52a0\u8f7d\u4e2d...":s.a.createElement("div",null,s.a.createElement("div",null,"\u52a0\u8f7d\u6570\u636e1:",n),s.a.createElement("div",null,"\u52a0\u8f7d\u6570\u636e2:",r))),s.a.createElement("button",{onClick:function(){t.refresh(),e.refresh()}},"\u5237\u65b0"))},h={id:"useRdxStatus",title:"useRdxStatus"},y={unversionedId:"api/useRdxStatus",id:"api/useRdxStatus",isDocsHomePage:!1,title:"useRdxStatus",description:"\u901a\u8fc7 useRdxStatus \u8fd9\u4e2a hooks\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a helper\uff0c\u5c06\u8be5 helper \u4f20\u7ed9 useRdxState \u53ef\u4ee5\u540c\u65f6\u8ba2\u9605\u591a\u4e2a RdxNode \u7684\u805a\u5408\u72b6\u6001\u3002",source:"@site/docs/api/useRdxStatus.mdx",slug:"/api/useRdxStatus",permalink:"/rdx-doc/docs/api/useRdxStatus",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/api/useRdxStatus.mdx",version:"current",sidebar:"someSidebar",previous:{title:"useRdxRefresh(state)",permalink:"/rdx-doc/docs/api/useRdxRefresh"},next:{title:"waitForAll(dependencies)",permalink:"/rdx-doc/docs/utils/waitForAll"}},E=[{value:"Example",id:"example",children:[]}],j={rightToc:E};function w(t){var e=t.components,n=Object(u.a)(t,["components"]);return Object(i.b)("wrapper",Object(a.a)({},j,n,{components:e,mdxType:"MDXLayout"}),Object(i.b)("p",null,"\u901a\u8fc7 useRdxStatus \u8fd9\u4e2a hooks\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a helper\uff0c\u5c06\u8be5 helper \u4f20\u7ed9 useRdxState \u53ef\u4ee5\u540c\u65f6\u8ba2\u9605\u591a\u4e2a RdxNode \u7684\u805a\u5408\u72b6\u6001\u3002"),Object(i.b)("p",null,"useRdxStatus \u7684\u76ee\u7684\u662f\u4e3a\u4e86\u66f4\u597d\u7684\u7ba1\u7406\u4e00\u4e2a\u7ec4\u4ef6\u5185\u90e8\u7684\u72b6\u6001\u3002"),Object(i.b)("p",null,"\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u7ec4\u4ef6\u8bbe\u8ba1\u884c\uff0c\u4f60\u4e00\u822c\u9700\u8981\u8003\u8651 5 \u79cd\u72b6\u6001\u3002 Blank State, Loading State, Partial State, Error State, Ideal State\u3002"),Object(i.b)("p",null,"\u5f53\u4e00\u4e2a\u7ec4\u4ef6\u7684\u72b6\u6001\u5168\u90fd\u662f\u540c\u6b65\u7684\uff0c\u90a3\u4e48 Blank State \u548c Ideal \u72b6\u6001\u662f\u65e0\u6cd5\u533a\u5206\u5f00\u7684\uff0c\u8fd9\u65f6\u5019\u4ec5\u9700\u8981\u8003\u8651 Ideal State."),Object(i.b)("p",null,"\u5f53\u4e00\u4e2a\u7ec4\u4ef6\u4f9d\u8d56\u7684\u72b6\u6001\u4e2d\u5b58\u5728\u5f02\u6b65\u7684\uff0c\u90a3\u4e48\u5c06\u4f1a\u6709 Loading State\uff0c Partial State\uff0c Error State\uff0c Ideal State \u8fd9\u6837 4 \u4e2a\u72b6\u6001\uff0c\u90a3\u4e48\u600e\u6837\u66f4\u597d\u7684\u6765\u83b7\u53d6\u8fd9\u4e9b\u72b6\u6001\u5462\uff1f"),Object(i.b)("p",null,"\u901a\u8fc7 useRdxStatus \u53ef\u4ee5\u805a\u5408\u591a\u4e2a useRdxState \u4e2d\u5173\u8054\u7684 RdxState \u7684\u72b6\u6001\u3002"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Error State, \u901a\u8fc7 isAnyError \u6765\u83b7\u53d6\uff0c \u901a\u8fc7 getErrors \u53ef\u4ee5\u83b7\u53d6\u5230\u9519\u8bef\u4fe1\u606f"),Object(i.b)("li",{parentName:"ul"},"Loading State, \u901a\u8fc7 isAnyPending \u6765\u83b7\u53d6\u3002"),Object(i.b)("li",{parentName:"ul"},"Partial State, \u901a\u8fc7 isPending(state)\u7684\u65b9\u5f0f\u6765\u5224\u65ad"),Object(i.b)("li",{parentName:"ul"},"IDeal State, \u5f53\u65e2\u4e0d\u662f Error \u72b6\u6001\u4e5f\u4e0d\u662f Loading \u72b6\u6001\u7684\u65f6\u5019\uff0c\u5c31\u662f\u7406\u60f3\u72b6\u6001\u3002")),Object(i.b)("h4",{id:"\u53c2\u8003"},"\u53c2\u8003"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(a.a)({parentName:"li"},{href:"https://ongspxm.wordpress.com/2015/11/29/ui-stack-in-web-design/"}),"UI Stack"))),Object(i.b)("hr",null),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-jsx"}),"function useRdxStatus<GModel>(): IStatusHelper;\n interface IStatusHelper {\n  // \u4efb\u610f\u4e00\u4e2a\u5173\u8054\u7684RdxNode\u5904\u4e8eStatus.Running \u6216\u8005Status.Waiting\u7684\u65f6\u5019,\u8fd4\u56detrue\uff0c\u53cd\u4e4b\u8fd4\u56defalse\n  isAnyPending: () => boolean;\n  // \u83b7\u53d6\u5f53\u524d\u7684state\u662f\u4e0d\u662f\u51fa\u4e8e\u7b49\u5f85\u72b6\u6001\u3002\n  isPending: (state: RdxState<any>) => boolean\n  // \u4efb\u610f\u4e00\u4e2a\u5173\u8054\u7684RdxNode\u5904\u4e8eStatus.Error \u7684\u65f6\u5019,\u8fd4\u56detrue\uff0c\u53cd\u4e4b\u8fd4\u56defalse\n  isAnyError: () => boolean;\n  // \u4efb\u610f\u4e00\u4e2a\u5173\u8054\u7684RdxNode\u5904\u4e8eStatus.Running \u6216\u8005Status.Waiting\u7684\u65f6\u5019,\u8fd4\u56deStatus.Running,\n  // \u4efb\u610f\u4e00\u4e2a\u5173\u8054\u7684RdxNode\u5904\u4e8eStatus.Error \u7684\u65f6\u5019,\u8fd4\u56deStatus.Error\n  // \u6240\u6709\u5173\u8054\u7684RdxNode\u52a0\u8f7d\u5b8c\u6210\u7684\u65f6\u5019\uff0c\u8fd4\u56deStatus.IDeal\n  getStatus: () => Status;\n  refresh: () => void;\n  // \u5f53\u4efb\u610f\u4e00\u4e2a\u5173\u8054\u7684RdxNode\u5904\u4e8eStatus.Error\u72b6\u6001\u7684\u65f6\u5019\uff0cgetErrors\u4f1a\u8fd4\u56de\u6240\u6709\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u5426\u5219\u8fd4\u56denull\n  getErrors: () => { id: string; msg: string }[] | null;\n}\nenum Status {\n  Running = 'Running',\n  IDeal = 'IDeal',\n  Error = 'Error',\n}\n")),Object(i.b)("hr",null),Object(i.b)("h3",{id:"example"},"Example"),Object(i.b)(l.a,{code:"import React from 'react';\nimport {\n  compute,\n  useRdxState,\n  RdxContext,\n  useRdxStatus,\n  useRdxValue,\n} from '@alife/rdx';\nconst pause = (t: number) => new Promise((resolve) => setTimeout(resolve, t));\nconst asyncCompute = compute({\n  id: 'asyncCompute',\n  get: async () => {\n    await pause(2000);\n    return '\u5ef6\u8fdf2s\u7684\u6570\u636e';\n  },\n});\n\nconst asyncCompute2 = compute({\n  id: 'asyncCompute22222',\n  get: async () => {\n    await pause(4000);\n    return '\u5ef6\u8fdf4s\u7684\u6570\u636e';\n  },\n});\n\nconst errorCompute = compute({\n  id: 'errorCompute',\n  get: async () => {\n    await pause(3000);\n    throw new Error('\u9519\u8bef\u72b6\u6001\u7684\u4f8b\u5b50');\n  },\n});\n\nexport const Root = () => {\n  return (\n    <RdxContext>\n      <Counter />\n    </RdxContext>\n  );\n};\nconst Counter = () => {\n  const mutator = useRdxStatus();\n  const mutator2 = useRdxStatus();\n  const state1 = useRdxValue(asyncCompute, mutator);\n  const state2 = useRdxValue(asyncCompute2, mutator);\n  const state3 = useRdxValue(errorCompute, mutator2);\n  return (\n    <div style={{}}>\n      <div>\n        <strong>Error state</strong>\n        {mutator2.isAnyError()\n          ? mutator2.getErrors().map((item) => item.msg)\n          : mutator2.isAnyPending()\n          ? '\u52a0\u8f7d\u4e2d\u3002\u3002\u3002'\n          : state3}\n      </div>\n      <div>\n        <strong>Parial state</strong>\n        <div>\n          \u52a0\u8f7d\u6570\u636e1:{mutator.isPending(asyncCompute) ? '\u52a0\u8f7d\u4e2d' : state1}\n        </div>\n        <div>\n          \u52a0\u8f7d\u6570\u636e2:{mutator.isPending(asyncCompute2) ? '\u52a0\u8f7d\u4e2d' : state2}\n        </div>\n      </div>\n      <div>\n        <strong>isAnyPending</strong>\n        {mutator.isAnyPending() ? (\n          '\u52a0\u8f7d\u4e2d...'\n        ) : (\n          <div>\n            <div>\u52a0\u8f7d\u6570\u636e1:{state1}</div>\n            <div>\u52a0\u8f7d\u6570\u636e2:{state2}</div>\n          </div>\n        )}\n      </div>\n      <button\n        onClick={() => {\n          mutator.refresh();\n          mutator2.refresh();\n        }}\n      >\n        \u5237\u65b0\n      </button>\n    </div>\n  );\n};\n",example:r,mdxType:"ExampleCustomizer"}))}w.isMDXComponent=!0}}]);